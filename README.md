# Sonny's Academy - AI-Powered LMS Platform

[![License: CC BY-NC 4.0](https://img.shields.io/badge/License-CC%20BY--NC%204.0-lightgrey.svg)](https://creativecommons.org/licenses/by-nc/4.0/)
[![Next.js 16](https://img.shields.io/badge/Next.js-16-black?logo=next.js)](https://nextjs.org/)
[![React 19](https://img.shields.io/badge/React-19-61DAFB?logo=react)](https://react.dev/)
[![Sanity](https://img.shields.io/badge/Sanity-CMS-F03E2F?logo=sanity)](https://www.sanity.io/)
[![Clerk](https://img.shields.io/badge/Clerk-Auth-6C47FF?logo=clerk)](https://clerk.com/)
[![Mux](https://img.shields.io/badge/Mux-Video-FF5A5F)](https://www.mux.com/)
[![OpenAI](https://img.shields.io/badge/OpenAI-GPT--4o-412991?logo=openai)](https://openai.com/)
[![Tailwind CSS](https://img.shields.io/badge/Tailwind-4.0-38B2AC?logo=tailwind-css)](https://tailwindcss.com/)

> **Learn to build production-ready LMS platforms** with modern architecture, AI-powered features, and bespoke CMS solutions.

---

<table>
<tr>
<td width="33%">

### ğŸ¯ Who This Is For

Developers who want to learn how to build **real-world course platforms** from scratch. Perfect for:
- Aspiring full-stack developers
- Developers exploring headless CMS
- Anyone building SaaS products

</td>
<td width="33%">

### âœ¨ What Makes This Special

- **Custom Admin Panel** built with Sanity App SDK (not just Studio!)
- **AI Learning Assistant** powered by GPT-4o
- **Tiered Subscriptions** with Clerk billing
- **Professional  Sonny's Academy - AI-Powered LMS Platform

[![License: CC BY-NC 4.0](https://img.shields.io/badge/License-CC%20BY--NC%204.0-lightgrey.svg)](https://creativecommons.org/licenses/by-nc/4.0/)
[![Next.js 16](https://img.shields.io/badge/Next.js-16-black?logo=next.js)](https://nextjs.org/)
[![React 19](https://img.shields.io/badge/React-19-61DAFB?logo=react)](https://react.dev/)
[![Sanity](https://img.shields.io/badge/Sanity-CMS-F03E2F?logo=sanity)](https://www.sanity.io/)
[![Clerk](https://img.shields.io/badge/Clerk-Auth-6C47FF?logo=clerk)](https://clerk.com/)
[![Mux](https://img.shields.io/badge/Mux-Video-FF5A5F)](https://www.mux.com/)
[![OpenAI](https://img.shields.io/badge/OpenAI-GPT--4o-412991?logo=openai)](https://openai.com/)
[![Tailwind CSS](https://img.shields.io/badge/Tailwind-4.0-38B2AC?logo=tailwind-css)](https://tailwindcss.com/)

> **Learn to build production-ready LMS platforms** with modern architecture, AI-powered features, and bespoke CMS solutions.

---

<table>
<tr>
<td width="33%">

### ğŸ¯ Who This Is For

Developers who waVideo Streaming** via Mux

</td>
<td width="33%">

### ğŸ› ï¸ Technical Highlights

- Next.js 16 App Router + React 19
- Real-time content updates with Sanity SDK
- Drag-and-drop course builder
- TypeScript end-to-end with typegen
- Modern UI with Shadcn + Tailwind 4

</td>
</tr>
</table>

---

## ğŸ‘‡ğŸ¼ DO THIS Before You Get Started

Before diving into the code, set up accounts with these services:

### ğŸ USE THESE Links!

> **âš ï¸ IMPORTANT:** Using these affiliate links helps keep this content FREE for everyone! Your support makes a huge difference.

<table>
<tr>
<th>Service</th>
<th>What It's For</th>
<th>Get Started</th>
</tr>
<tr>
<td><strong>ğŸŸ¢ Sanity</strong></td>
<td>Headless CMS for all your content</td>
<td><a href="https://www.sanity.io/sonny?utm_source=youtube&utm_medium=video&utm_content=ai-lms-platform"><strong>ğŸ‘‰ Get Started with Sanity</strong></a></td>
</tr>
<tr>
<td><strong>ğŸ” Clerk</strong></td>
<td>Authentication & subscription billing</td>
<td><a href="https://go.clerk.com/5fXjeWr"><strong>ğŸ‘‰ Get Started with Clerk</strong></a></td>
</tr>
<tr>
<td><strong>ğŸ¤– CodeRabbit</strong></td>
<td>AI-powered code reviews</td>
<td><a href="https://coderabbit.link/sonny-dec"><strong>ğŸ‘‰ Get Started with CodeRabbit</strong></a></td>
</tr>
</table>

**ğŸ’¡ Pro Tip:** These are the exact services used in production - you'll need them to follow along!

### Other Required Services

| Service | What It's For | Get Started |
|---------|---------------|-------------|
| **Mux** | Video hosting & streaming | ğŸ‘‰ [mux.com](https://www.mux.com/) |
| **OpenAI** | AI tutor functionality | ğŸ‘‰ [platform.openai.com](https://platform.openai.com/) |

---

## ğŸ“– What Is This App?

**Think of Sonny's Academy as Netflix for courses, but with an AI tutor that knows everything about your content.**

This is a Learning Management System (LMS) - a platform where:
- **Creators** upload and organize video courses
- **Learners** watch lessons, track progress, and get AI-powered help
- **Admins** manage everything through a beautiful custom dashboard

### Key Concepts

| Concept | What It Means |
|---------|---------------|
| **Course** | A collection of modules on a topic (e.g., "Master React") |
| **Module** | A chapter within a course (e.g., "React Hooks Deep Dive") |
| **Lesson** | An individual video + notes (e.g., "Understanding useState") |
| **Tier** | Access level: Free, Pro ($), or Ultra ($$) |
| **AI Tutor** | Chat assistant that searches your course content to answer questions |

### Example Use Cases

- ğŸ“ **Online Course Platform** - Sell programming courses with subscription tiers
- ğŸ¢ **Corporate Training** - Internal training portal for employees
- ğŸ“š **Educational Institution** - Supplement classroom learning with video content

---

## ğŸš€ Before We Dive In - Join the PAPAFAM!

**Want to build apps like this from scratch?** Join thousands of developers leveling up their skills!

### What You'll Master

- âš›ï¸ Modern React patterns & Next.js App Router
- ğŸ—„ï¸ Headless CMS architecture with Sanity
- ğŸ” Production authentication & billing flows
- ğŸ¤– AI integration with tool calling & RAG patterns
- ğŸ“¹ Professional video streaming infrastructure
- ğŸ¨ Beautiful UI with Tailwind CSS & Shadcn

### PAPAFAM Community Benefits

- ğŸ“º **Full Build Videos** - Watch every line of code being written
- ğŸ’¬ **Discord Community** - Get help from Sonny and 50,000+ developers
- ğŸ† **Project Portfolio** - Ship real projects, not toy apps
- ğŸ¯ **Career Guidance** - From beginner to job-ready

### Real Results

> "I went from tutorial hell to shipping production apps in 3 months" - PAPAFAM Graduate

### What's Included

- Step-by-step video tutorials
- Complete source code access
- Private Discord channels
- Weekly live coding sessions
- Resume & portfolio reviews

ğŸ‘‰ **[Join the PAPAFAM Today](https://www.papareact.com/course)**

---

## â­ Features

### For Learners

| Feature | Free | Pro | Ultra |
|---------|:----:|:---:|:-----:|
| Access to foundational courses | âœ… | âœ… | âœ… |
| Community Discord access | âœ… | âœ… | âœ… |
| Basic projects & exercises | âœ… | âœ… | âœ… |
| Email support | âœ… | âœ… | âœ… |
| All Pro-tier courses | âŒ | âœ… | âœ… |
| Advanced real-world projects | âŒ | âœ… | âœ… |
| Priority support | âŒ | âœ… | âœ… |
| Course completion certificates | âŒ | âœ… | âœ… |
| **ğŸ¤– AI Learning Assistant** | âŒ | âŒ | âœ… |
| Exclusive Ultra-only content | âŒ | âŒ | âœ… |
| Monthly 1-on-1 sessions | âŒ | âŒ | âœ… |
| Private Discord channel | âŒ | âŒ | âœ… |
| Early access to new courses | âŒ | âŒ | âœ… |
| Lifetime updates | âŒ | âŒ | âœ… |

### For Developers (Technical Features)

#### ğŸ—ï¸ The `/admin` vs `/studio` Paradigm

This project teaches you **two different approaches** to content management:

| Route | Technology | Purpose |
|-------|------------|---------|
| `/admin` | **Sanity App SDK** | Custom bespoke CMS frontend - Build your own admin experience |
| `/studio` | **Sanity Studio** | Traditional Sanity Studio - Full CMS fallback |

**Why both?** The `/admin` route demonstrates how to build a completely custom content management experience using Sanity's App SDK. This is the modern way to create bespoke backends tailored to your exact needs. The `/studio` route serves as a fallback for advanced CMS operations.

#### Sanity App SDK Features Used

```typescript
// Hooks for real-time document editing
import {
  useDocument,        // Read document/field data
  useEditDocument,    // Edit document fields
  useDocuments,       // List all documents of a type
  useQuery,           // Run GROQ queries
  useApplyDocumentActions,  // Apply document mutations
} from "@sanity/sdk-react";

// Document actions
import {
  publishDocument,
  unpublishDocument,
  discardDocument,
  deleteDocument,
  createDocument,
} from "@sanity/sdk-react";
```

#### Custom Admin Components

- ğŸ“ **CourseEditor** - Full course editing with modules sidebar
- ğŸ¯ **ModuleAccordionInput** - Drag-and-drop module reordering
- ğŸ–¼ï¸ **ImageInput** - Image upload with preview
- ğŸ”— **ReferenceInput** - Document reference picker
- ğŸ·ï¸ **SlugInput** - Auto-generated URL slugs
- âš¡ **DocumentActions** - Publish/Unpublish/Discard/Delete

#### ğŸ¤– AI Learning Assistant

- Powered by **GPT-4o** via Vercel AI SDK
- **Tool calling** to search course content
- Semantic search across courses, modules, and lessons
- Only available to Ultra subscribers

#### ğŸ“¹ Video Streaming

- **Mux** integration for professional video hosting
- Signed playback tokens for security
- Adaptive bitrate streaming
- Thumbnail and storyboard generation

#### ğŸ” Authentication & Billing

- **Clerk** handles auth, users, and subscriptions
- Pricing table component for plan selection
- Tier-based content gating
- Webhook integration for billing events

#### ğŸ“Š Progress Tracking

- Mark lessons as complete
- Track course completion percentage
- Per-user progress stored in Sanity

---

## ğŸ”„ How It Works

### User Journey

```mermaid
flowchart LR
    A[Visit Site] --> B{Signed In?}
    B -->|No| C[Browse Free Courses]
    B -->|Yes| D[Dashboard]
    C --> E[Sign Up with Clerk]
    E --> D
    D --> F[Browse All Courses]
    F --> G{Has Access?}
    G -->|Yes| H[Watch Lessons]
    G -->|No| I[Upgrade Plan]
    I --> F
    H --> J[Mark Complete]
    J --> K[Get Certificate]
```

### Content Hierarchy

```mermaid
flowchart TD
    A[Course] --> B[Module 1]
    A --> C[Module 2]
    A --> D[Module 3]
    B --> E[Lesson 1.1]
    B --> F[Lesson 1.2]
    C --> G[Lesson 2.1]
    C --> H[Lesson 2.2]
    C --> I[Lesson 2.3]
    D --> J[Lesson 3.1]
```

### Admin vs Studio Architecture

```mermaid
flowchart TB
    subgraph "Custom Admin /admin"
        A1[React Components] --> A2[Sanity App SDK]
        A2 --> A3[useDocument]
        A2 --> A4[useEditDocument]
        A2 --> A5[useApplyDocumentActions]
    end
    
    subgraph "Sanity Studio /studio"
        B1[NextStudio] --> B2[Sanity Config]
        B2 --> B3[Schema Types]
        B2 --> B4[Desk Structure]
    end
    
    A3 --> C[Sanity API]
    A4 --> C
    A5 --> C
    B1 --> C
    C --> D[(Sanity Dataset)]
```

### AI Tutor Flow

```mermaid
sequenceDiagram
    participant U as User
    participant T as Tutor Widget
    participant A as AI Agent
    participant S as Search Tool
    participant DB as Sanity

    U->>T: Ask question
    T->>A: Send message
    A->>S: searchCourses tool
    S->>DB: GROQ query
    DB-->>S: Course content
    S-->>A: Relevant lessons
    A-->>T: Answer with citations
    T-->>U: Display response
```

---

## ğŸš€ Getting Started

### Prerequisites

- **Node.js 18+** (recommend using [nvm](https://github.com/nvm-sh/nvm))
- **pnpm** (package manager)
- Accounts: Sanity, Clerk, Mux, OpenAI

### Installation

1. **Clone the repository**

```bash
git clone https://github.com/your-username/sonnys-academy.git
cd sonnys-academy
```

2. **Install dependencies**

```bash
pnpm install
```

3. **Copy environment variables**

```bash
cp .env.example .env.local
```

4. **Configure environment variables** (see below)

5. **Run development server**

```bash
pnpm dev
```

6. **Open the app**

- Main app: [http://localhost:3000](http://localhost:3000)
- Admin panel: [http://localhost:3000/admin](http://localhost:3000/admin)
- Sanity Studio: [http://localhost:3000/studio](http://localhost:3000/studio)

### Environment Variables

Create a `.env.local` file with the following variables:

```bash
# Sanity Configuration
NEXT_PUBLIC_SANITY_PROJECT_ID=your_project_id
NEXT_PUBLIC_SANITY_DATASET=production
NEXT_PUBLIC_SANITY_API_VERSION=2025-11-27

# Clerk Authentication
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_...
CLERK_SECRET_KEY=sk_test_...

# OpenAI (for AI Tutor)
OPENAI_API_KEY=sk-...

# Mux Video
MUX_TOKEN_ID=your_mux_token_id
MUX_TOKEN_SECRET=your_mux_token_secret
MUX_SIGNING_KEY_ID=your_signing_key_id
MUX_SIGNING_KEY_PRIVATE=your_signing_key_private
```

> âš ï¸ **Security Notes:**
> - Never commit `.env.local` to version control
> - Variables starting with `NEXT_PUBLIC_` are exposed to the browser
> - Keep `CLERK_SECRET_KEY` and `MUX_SIGNING_KEY_PRIVATE` strictly server-side

### First-Time Setup Checklist

- [ ] Create Sanity project and get credentials
- [ ] Set up Clerk application with pricing plans (Free, Pro, Ultra)
- [ ] Configure Clerk webhooks for billing events
- [ ] Create Mux account and get API tokens
- [ ] Generate Mux signing keys for secure playback
- [ ] Add OpenAI API key
- [ ] Run `pnpm dev` and verify all pages load
- [ ] Create your first course via `/admin` or `/studio`

---

## ğŸ—„ï¸ Database Schema Overview

### Document Types

| Type | Description | Key Fields |
|------|-------------|------------|
| **Course** | Top-level learning container | title, slug, description, tier, modules[], featured |
| **Module** | Groups related lessons | title, description, lessons[] |
| **Lesson** | Individual learning unit | title, slug, description, video, content, completedBy[] |
| **Category** | Organizes courses | title, description |
| **Note** | User notes (demo feature) | title, content, status |

### Relationships

```
Course
â”œâ”€â”€ category (reference â†’ Category)
â”œâ”€â”€ modules[] (references â†’ Module[])
â”‚   â””â”€â”€ lessons[] (references â†’ Lesson[])
â””â”€â”€ completedBy[] (user IDs who completed)

Lesson
â”œâ”€â”€ video (Mux video asset)
â”œâ”€â”€ content (Portable Text)
â””â”€â”€ completedBy[] (user IDs who completed)
```

### Design Decisions

1. **References over embedding** - Modules and lessons are separate documents referenced by courses. This allows reusing content across courses.

2. **Completion tracking in documents** - User completion is stored as arrays of user IDs directly on course/lesson documents for simplicity.

3. **Tier on courses, not lessons** - Access control is at the course level. All lessons in a course inherit its tier.

4. **Portable Text for lesson content** - Rich text with full formatting support for lesson notes.

---

## ğŸš¢ Deployment

### Deploy to Vercel

#### Option 1: Vercel CLI

```bash
# Install Vercel CLI
pnpm i -g vercel

# Deploy
vercel

# For production
vercel --prod
```

#### Option 2: GitHub Integration

1. Push your code to GitHub
2. Go to [vercel.com](https://vercel.com)
3. Import your repository
4. Add environment variables
5. Deploy!

### Post-Deployment Checklist

- [ ] Verify all environment variables are set in Vercel
- [ ] Test authentication flow (sign up, sign in, sign out)
- [ ] Test subscription purchase flow
- [ ] Verify video playback works
- [ ] Test AI tutor (Ultra accounts only)
- [ ] Set up Clerk webhooks with production URL
- [ ] Configure Sanity CORS for production domain

### Configure Clerk Webhooks

1. Go to Clerk Dashboard â†’ Webhooks
2. Add endpoint: `https://your-domain.com/api/webhooks/clerk`
3. Select events: `user.created`, `user.updated`, `subscription.created`, `subscription.updated`

---

## ğŸ”§ Common Issues & Solutions

### Authentication Issues

| Problem | Solution |
|---------|----------|
| "Clerk not loading" | Check `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY` is set correctly |
| "Unauthorized" errors | Verify `CLERK_SECRET_KEY` matches your Clerk app |
| Subscription not recognized | Check Clerk webhook is configured and receiving events |

### Video Issues

| Problem | Solution |
|---------|----------|
| Videos not playing | Verify Mux credentials are correct |
| "Playback token invalid" | Check `MUX_SIGNING_KEY_PRIVATE` is properly formatted |
| Videos stuck loading | Ensure Mux asset status is "ready" in Sanity |

### Sanity Issues

| Problem | Solution |
|---------|----------|
| "Project not found" | Double-check `NEXT_PUBLIC_SANITY_PROJECT_ID` |
| Content not updating | Check you're using the correct dataset |
| TypeScript errors | Run `pnpm typegen` to regenerate types |
| Schema changes not appearing | Restart dev server and rebuild Studio |

### AI Tutor Issues

| Problem | Solution |
|---------|----------|
| Tutor not responding | Verify `OPENAI_API_KEY` is valid |
| "No content found" | Ensure courses have published content |
| Tutor showing for non-Ultra users | Check Clerk subscription configuration |

---

## ğŸ† Take It Further - Challenge Time!

Ready to level up? Here are advanced features to build:

### Learning Features

- [ ] **Quizzes** - Add quiz questions after each lesson
- [ ] **Certificates** - Generate PDF certificates on course completion
- [ ] **Discussion forums** - Comment sections for each lesson
- [ ] **Bookmarks** - Save favorite lessons for later

### AI Improvements

- [ ] **Multiple AI models** - Add Claude, Gemini support
- [ ] **Chat history** - Persist tutor conversations
- [ ] **Contextual help** - Auto-suggest based on current lesson
- [ ] **Content generation** - AI-assisted lesson writing

### Infrastructure & Scaling

- [ ] **Search** - Full-text search with Algolia or Typesense
- [ ] **Analytics** - Track engagement with Posthog or Plausible
- [ ] **Email notifications** - Course updates, completion emails
- [ ] **Multi-tenancy** - White-label for organizations

### Monetization

- [ ] **One-time purchases** - Buy individual courses
- [ ] **Gift subscriptions** - Purchase for others
- [ ] **Affiliate program** - Referral commissions
- [ ] **Team plans** - B2B licensing

---

## ğŸ“„ License

This project is licensed under the **Creative Commons Attribution-NonCommercial 4.0 International License**.

### You CAN:

- âœ… Use this code for learning and personal projects
- âœ… Modify and adapt the code
- âœ… Share your modifications (with attribution)
- âœ… Use as a portfolio piece

### You CANNOT:

- âŒ Use this code for commercial purposes
- âŒ Sell courses or templates based on this code
- âŒ Remove attribution to the original author
- âŒ Use for client work without a commercial license

### Need Commercial Use?

Contact [Sonny Sangha](https://www.papareact.com) for commercial licensing options.

See [LICENSE.md](LICENSE.md) for the full license text.

---

## ğŸ“š Quick Reference

### Useful Commands

```bash
# Development
pnpm dev              # Start dev server
pnpm build            # Production build
pnpm start            # Start production server

# Type Generation
pnpm typegen          # Generate Sanity types
pnpm typecheck        # Check TypeScript

# Code Quality
pnpm lint             # Run Biome linter
pnpm format           # Format with Biome
```

### Key Files & Folders

```
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ (admin)/admin/     # Custom admin panel (Sanity App SDK)
â”‚   â”œâ”€â”€ (app)/             # Main learner-facing app
â”‚   â”œâ”€â”€ studio/            # Sanity Studio
â”‚   â””â”€â”€ api/               # API routes (AI chat)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ admin/             # Admin components & editors
â”‚   â”œâ”€â”€ courses/           # Course display components
â”‚   â”œâ”€â”€ lessons/           # Lesson player & sidebar
â”‚   â”œâ”€â”€ tutor/             # AI tutor widget
â”‚   â””â”€â”€ ui/                # Shadcn components
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ actions/           # Server actions
â”‚   â”œâ”€â”€ ai/                # AI agent & tools
â”‚   â””â”€â”€ hooks/             # Custom React hooks
â”œâ”€â”€ sanity/
â”‚   â”œâ”€â”€ schemaTypes/       # Sanity schema definitions
â”‚   â””â”€â”€ lib/               # Sanity client & queries
â””â”€â”€ sanity.config.ts       # Sanity Studio config
```

### Important Concepts

| Concept | File(s) | Description |
|---------|---------|-------------|
| Sanity App SDK Provider | `components/SanityAppProvider.tsx` | Wraps app with Sanity SDK context |
| Tier Access Control | `lib/course-access.ts` | Checks user subscription tier |
| AI Tutor Agent | `lib/ai/tutor-agent.ts` | GPT-4o agent with course search tool |
| Document Actions | `components/admin/documents/DocumentActions.tsx` | Publish/unpublish/delete logic |
| Tier Features | `lib/constants.ts` | Feature list per subscription tier |

---

<p align="center">
  <strong>Built with â¤ï¸ by <a href="https://www.papareact.com">Sonny Sangha</a></strong>
  <br />
  <a href="https://www.papareact.com/course">Join the PAPAFAM</a> â€¢
  <a href="https://www.youtube.com/@SonnySangha">YouTube</a> â€¢
  <a href="https://twitter.com/SonnySangha">Twitter</a>
</p>
